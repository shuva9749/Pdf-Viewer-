<!DOCTYPE html>
<html>
<head>
  <title>Google Drive File Picker</title>
  <meta name="google-signin-client_id" content="705204588232-3m2bivi6c0nd41lgpe7j34abim8s0gta.apps.googleusercontent.com">
  <style>
    /* ==== CSS Section ==== */
    #pickButton {
      position: fixed;
      top: 50px;
      left: 20px;
      padding: 10px 20px;
      background-color: #4285F4;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #fileInfo {
      margin: 100px 20px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <!-- ==== HTML Section ==== -->
  <button id="pickButton">Pick File from Google Drive</button>
  <div id="fileInfo"></div>

  <!-- ==== JavaScript Section ==== -->
  <script type="text/javascript">
    const developerKey = 'AIzaSyAs1-yX51Kd5aKl-mB1oHhKXhOwCUDcPUY';
    const clientId = '705204588232-3m2bivi6c0nd41lgpe7j34abim8s0gta.apps.googleusercontent.com';
    const scope = ['https://www.googleapis.com/auth/drive.file'];

    let pickerApiLoaded = false;
    let oauthToken;

    function onApiLoad() {
      gapi.load('auth', { 'callback': onAuthApiLoad });
      gapi.load('picker', { 'callback': onPickerApiLoad });
    }

    function onAuthApiLoad() {
      gapi.auth.authorize(
        {
          client_id: clientId,
          scope: scope,
          immediate: false
        },
        handleAuthResult
      );
    }

    function onPickerApiLoad() {
      pickerApiLoaded = true;
    }

    function handleAuthResult(authResult) {
      if (authResult && !authResult.error) {
        oauthToken = authResult.access_token;
        createPicker();
      }
    }

    function createPicker() {
      if (pickerApiLoaded && oauthToken) {
        const view = new google.picker.View(google.picker.ViewId.DOCS);
        const picker = new google.picker.PickerBuilder()
          .enableFeature(google.picker.Feature.NAV_HIDDEN)
          .setOAuthToken(oauthToken)
          .setDeveloperKey(developerKey)
          .addView(view)
          .setCallback(pickerCallback)
          .build();
        picker.setVisible(true);
      }
    }

    function pickerCallback(data) {
      if (data.action === google.picker.Action.PICKED) {
        const file = data.docs[0];
        document.getElementById('fileInfo').innerHTML =
          `<strong>File Name:</strong> ${file.name}<br>
           <strong>URL:</strong> <a href="${file.url}" target="_blank">${file.url}</a>`;
      }
    }

    document.getElementById('pickButton').addEventListener('click', onApiLoad);
  </script>

  <!-- Load Google APIs -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://apis.google.com/js/client.js?onload=onApiLoad"></script>
</body>
</html>
